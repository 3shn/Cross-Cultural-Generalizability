par(new = TRUE)
dens <- density(s$transport_p[,i])
x1 <- min(which(dens$x >= quantile(s$transport_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s$transport_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.2), border = NA))
abline(v = 0, lty = 2)
}
mtext("Effect of norm prime on prosocial choices", side = 1,line = 1.5,outer = TRUE, cex = 0.8)
mtext("'Transport' of causal effect to the Wichí (ARG)", side = 3,line = 1.5,outer = TRUE, cex = 1)
dev.off()
s_basic
par(mfrow= c(3,2),
oma=c(3,2,3,0),
mar=c(2,0,1,1))
for (i in 1:6) {
dens <- density(s_basic$empirical_p[,i])
x1 <- min(which(dens$x >= quantile(s_basic$empirical_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s_basic$empirical_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.7), border = NA))
abline(v = 0, lty = 2)
mtext(Society[i], side = 2, line = -3, cex = 0.7)
if (i ==1) legend("topright", c("Empirical estimates", "Transported estimates"), col = c(alpha("black",alpha = 0.7),alpha("black",alpha = 0.2)), cex = 0.7, lwd = 8, lty = 1, bty = "n")
par(new = TRUE)
dens <- density(s$transport_p[,i])
x1 <- min(which(dens$x >= quantile(s$transport_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s$transport_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.2), border = NA))
abline(v = 0, lty = 2)
}
mtext("Effect of norm prime on prosocial choices", side = 1,line = 1.5,outer = TRUE, cex = 0.8)
mtext("'Transport' of causal effect to the Wichí (ARG)", side = 3,line = 1.5,outer = TRUE, cex = 1)
model_basic <- "
data {
int N;
int N_pop;
int MA;
int age[N];
int pop_id[N];
int condition[N];
int outcome[N];
int gender[N];
int Demo[N_pop, MA];
int Ref;
}
parameters {
real alpha[N_pop];
real b_prime[N_pop];
}
model {
vector[N] p;
alpha ~ normal(0, 1);
b_prime ~ normal(0, 3);
for ( i in 1:N ) {
p[i] = alpha[pop_id[i]] + b_prime[pop_id[i]] * condition[i];
}
outcome ~ binomial_logit(1, p);
}
generated quantities{
real empirical_p[N_pop];
for (h in 1:N_pop){
empirical_p[h] =  inv_logit(alpha[h]) - inv_logit(alpha[h] + b_prime[h]);
}
}
"
m_basic <- stan( model_code  = model_basic , data= d_list ,iter = 5000, cores = 4, seed=1, chains=4, control = list(adapt_delta=0.95, max_treedepth = 15))
s_basic <- extract.samples(m_basic)
par(mfrow= c(3,2),
oma=c(3,2,3,0),
mar=c(2,0,1,1))
for (i in 1:6) {
dens <- density(s_basic$empirical_p[,i])
x1 <- min(which(dens$x >= quantile(s_basic$empirical_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s_basic$empirical_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.7), border = NA))
abline(v = 0, lty = 2)
mtext(Society[i], side = 2, line = -3, cex = 0.7)
if (i ==1) legend("topright", c("Empirical estimates", "Transported estimates"), col = c(alpha("black",alpha = 0.7),alpha("black",alpha = 0.2)), cex = 0.7, lwd = 8, lty = 1, bty = "n")
par(new = TRUE)
dens <- density(s$transport_p[,i])
x1 <- min(which(dens$x >= quantile(s$transport_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s$transport_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.2), border = NA))
abline(v = 0, lty = 2)
}
mtext("Effect of norm prime on prosocial choices", side = 1,line = 1.5,outer = TRUE, cex = 0.8)
mtext("'Transport' of causal effect to the Wichí (ARG)", side = 3,line = 1.5,outer = TRUE, cex = 1)
model_basic <- "
data {
int N;
int N_pop;
int MA;
int age[N];
int pop_id[N];
int condition[N];
int outcome[N];
int gender[N];
int Demo[N_pop, MA];
int Ref;
}
parameters {
real alpha[N_pop];
real b_prime[N_pop];
}
model {
vector[N] p;
alpha ~ normal(0, 1);
b_prime ~ normal(0, 2);
for ( i in 1:N ) {
p[i] = alpha[pop_id[i]] + b_prime[pop_id[i]] * condition[i];
}
outcome ~ binomial_logit(1, p);
}
generated quantities{
real empirical_p[N_pop];
for (h in 1:N_pop){
empirical_p[h] =  inv_logit(alpha[h]) - inv_logit(alpha[h] + b_prime[h]);
}
}
"
par(mfrow= c(3,2),
oma=c(3,2,3,0),
mar=c(2,0,1,1))
for (i in 1:6) {
dens <- density(s_basic$empirical_p[,i])
x1 <- min(which(dens$x >= quantile(s_basic$empirical_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s_basic$empirical_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.7), border = NA))
abline(v = 0, lty = 2)
mtext(Society[i], side = 2, line = -3, cex = 0.7)
if (i ==1) legend("topright", c("Empirical estimates", "Transported estimates"), col = c(alpha("black",alpha = 0.7),alpha("black",alpha = 0.2)), cex = 0.7, lwd = 8, lty = 1, bty = "n")
par(new = TRUE)
dens <- density(s$transport_p[,i])
x1 <- min(which(dens$x >= quantile(s$transport_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s$transport_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.2), border = NA))
abline(v = 0, lty = 2)
}
mtext("Effect of norm prime on prosocial choices", side = 1,line = 1.5,outer = TRUE, cex = 0.8)
mtext("'Transport' of causal effect to the Wichí (ARG)", side = 3,line = 1.5,outer = TRUE, cex = 1)
m_basic <- stan( model_code  = model_basic , data= d_list ,iter = 5000, cores = 4, seed=1, chains=4, control = list(adapt_delta=0.95, max_treedepth = 15))
s_basic <- extract.samples(m_basic)
par(mfrow= c(3,2),
oma=c(3,2,3,0),
mar=c(2,0,1,1))
for (i in 1:6) {
dens <- density(s_basic$empirical_p[,i])
x1 <- min(which(dens$x >= quantile(s_basic$empirical_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s_basic$empirical_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.7), border = NA))
abline(v = 0, lty = 2)
mtext(Society[i], side = 2, line = -3, cex = 0.7)
if (i ==1) legend("topright", c("Empirical estimates", "Transported estimates"), col = c(alpha("black",alpha = 0.7),alpha("black",alpha = 0.2)), cex = 0.7, lwd = 8, lty = 1, bty = "n")
par(new = TRUE)
dens <- density(s$transport_p[,i])
x1 <- min(which(dens$x >= quantile(s$transport_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s$transport_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.2), border = NA))
abline(v = 0, lty = 2)
}
mtext("Effect of norm prime on prosocial choices", side = 1,line = 1.5,outer = TRUE, cex = 0.8)
mtext("'Transport' of causal effect to the Wichí (ARG)", side = 3,line = 1.5,outer = TRUE, cex = 1)
graphics.off()
png("Transport2.png", res = 1200, height = 12, width = 16, units = "cm")
par(mfrow= c(3,2),
oma=c(3,2,3,0),
mar=c(2,0,1,1))
for (i in 1:6) {
dens <- density(s_basic$empirical_p[,i])
x1 <- min(which(dens$x >= quantile(s_basic$empirical_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s_basic$empirical_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.7), border = NA))
abline(v = 0, lty = 2)
mtext(Society[i], side = 2, line = -3, cex = 0.7)
if (i ==1) legend("topright", c("Empirical estimates", "Transported estimates"), col = c(alpha("black",alpha = 0.7),alpha("black",alpha = 0.2)), cex = 0.7, lwd = 8, lty = 1, bty = "n")
par(new = TRUE)
dens <- density(s$transport_p[,i])
x1 <- min(which(dens$x >= quantile(s$transport_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s$transport_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.2), border = NA))
abline(v = 0, lty = 2)
}
mtext("Effect of norm prime on prosocial choices", side = 1,line = 1.5,outer = TRUE, cex = 0.8)
mtext("'Transport' of causal effect to the Wichí (ARG)", side = 3,line = 1.5,outer = TRUE, cex = 1)
dev.off()
model <- "
functions{
matrix GPL(int K, real C, real D, real S){
matrix[K,K] Rho;
real KR;
KR = K;
for(i in 1:(K-1)){
for(j in (i+1):K){
Rho[i,j] = C * exp(-D * ( (j-i)^2 / KR^2) );
Rho[j,i] = Rho[i,j];
}}
for (i in 1:K){
Rho[i,i] = 1;
}
return S*cholesky_decompose(Rho);
}
}
data {
int N;
int N_pop;
int MA;
int age[N];
int pop_id[N];
int condition[N];
int outcome[N];
int gender[N];
int Demo[N_pop, MA];
int Ref;
}
parameters {
real alpha[N_pop];
real b_prime[N_pop];
matrix[N_pop, MA] age_effect;    //Vector for GP age effects
real<lower=0> eta[N_pop];
real<lower=0> sigma[N_pop];
real<lower=0, upper=1> rho[N_pop];
}
model {
vector[N] p;
alpha ~ normal(0, 1);
b_prime ~ normal(0, 2);
eta ~ exponential(2);
sigma ~ exponential(1);
rho ~ beta(10, 1);
for (h in 1:N_pop){
age_effect[h,] ~ multi_normal_cholesky( rep_vector(0, MA) , GPL(MA, rho[h], eta[h], sigma[h]) );
}
for ( i in 1:N ) {
p[i] = alpha[pop_id[i]] + (b_prime[pop_id[i]] + age_effect[pop_id[i],age[i]]) * condition[i];
}
outcome ~ binomial_logit(1, p);
}
generated quantities{
real empirical_p[N_pop];
real transport_p[N_pop];
for (h in 1:N_pop){
real empirical_total = 0;
real transport_total = 0;
for ( i in 1:MA){
empirical_total+= Demo[h,i] * (inv_logit(alpha[h]) - inv_logit(alpha[h] + (b_prime[h] + age_effect[h,i])) );
transport_total+= Demo[Ref,i] * (inv_logit(alpha[h]) - inv_logit(alpha[h] + (b_prime[h] + age_effect[h,i])) );
}
empirical_p[h] = empirical_total / sum(Demo[h,]);
transport_p[h] = transport_total / sum(Demo[Ref,]);
}
}
"
m <- stan( model_code  = model , data= d_list ,iter = 2000, cores = 4, seed=1, chains=4, control = list(adapt_delta=0.9, max_treedepth = 15))
precis(m)
precis(m,2)
precis(m,3)
s <- extract.samples(m)
par(mfrow= c(3,2),
oma=c(3,2,3,0),
mar=c(2,0,1,1))
for (i in 1:6) {
dens <- density(s_basic$empirical_p[,i])
x1 <- min(which(dens$x >= quantile(s_basic$empirical_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s_basic$empirical_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.7), border = NA))
abline(v = 0, lty = 2)
mtext(Society[i], side = 2, line = -3, cex = 0.7)
if (i ==1) legend("topright", c("Empirical estimates", "Transported estimates"), col = c(alpha("black",alpha = 0.7),alpha("black",alpha = 0.2)), cex = 0.7, lwd = 8, lty = 1, bty = "n")
par(new = TRUE)
dens <- density(s$transport_p[,i])
x1 <- min(which(dens$x >= quantile(s$transport_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s$transport_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.2), border = NA))
abline(v = 0, lty = 2)
}
mtext("Effect of norm prime on prosocial choices", side = 1,line = 1.5,outer = TRUE, cex = 0.8)
mtext("'Transport' of causal effect to the Wichí (ARG)", side = 3,line = 1.5,outer = TRUE, cex = 1)
precis(m,2)
#Prepare for stan
d_list <- list(N = nrow(data),
N_pop = length(unique(data$fieldid)),
MA = 12,
pop_id = data$fieldid,
age = data$age - 3,
condition = data$condition-1,
outcome = data$choice,
gender = data$gender,
Demo = Demo,
Ref = 6)
model <- "
functions{
matrix GPL(int K, real C, real D, real S){
matrix[K,K] Rho;
real KR;
KR = K;
for(i in 1:(K-1)){
for(j in (i+1):K){
Rho[i,j] = C * exp(-D * ( (j-i)^2 / KR^2) );
Rho[j,i] = Rho[i,j];
}}
for (i in 1:K){
Rho[i,i] = 1;
}
return S*cholesky_decompose(Rho);
}
}
data {
int N;
int N_pop;
int MA;
int age[N];
int pop_id[N];
int condition[N];
int outcome[N];
int gender[N];
int Demo[N_pop, MA];
int Ref;
}
parameters {
real alpha[N_pop];
real b_prime[N_pop];
matrix[N_pop, MA] age_effect;    //Vector for GP age effects
real<lower=0> eta[N_pop];
real<lower=0> sigma[N_pop];
real<lower=0, upper=1> rho[N_pop];
}
model {
vector[N] p;
alpha ~ normal(0, 1);
b_prime ~ normal(0, 3);
eta ~ exponential(2);
sigma ~ exponential(1);
rho ~ beta(10, 1);
for (h in 1:N_pop){
age_effect[h,] ~ multi_normal_cholesky( rep_vector(0, MA) , GPL(MA, rho[h], eta[h], sigma[h]) );
}
for ( i in 1:N ) {
p[i] = alpha[pop_id[i]] + (b_prime[pop_id[i]] + age_effect[pop_id[i],age[i]]) * condition[i];
}
outcome ~ binomial_logit(1, p);
}
generated quantities{
real empirical_p[N_pop];
real transport_p[N_pop];
for (h in 1:N_pop){
real empirical_total = 0;
real transport_total = 0;
for ( i in 1:MA){
empirical_total+= Demo[h,i] * (inv_logit(alpha[h]) - inv_logit(alpha[h] + (b_prime[h] + age_effect[h,i])) );
transport_total+= Demo[Ref,i] * (inv_logit(alpha[h]) - inv_logit(alpha[h] + (b_prime[h] + age_effect[h,i])) );
}
empirical_p[h] = empirical_total / sum(Demo[h,]);
transport_p[h] = transport_total / sum(Demo[Ref,]);
}
}
"
model_basic <- "
data {
int N;
int N_pop;
int MA;
int age[N];
int pop_id[N];
int condition[N];
int outcome[N];
int gender[N];
int Demo[N_pop, MA];
int Ref;
}
parameters {
real alpha[N_pop];
real b_prime[N_pop];
}
model {
vector[N] p;
alpha ~ normal(0, 1);
b_prime ~ normal(0, 3);
for ( i in 1:N ) {
p[i] = alpha[pop_id[i]] + b_prime[pop_id[i]] * condition[i];
}
outcome ~ binomial_logit(1, p);
}
generated quantities{
real empirical_p[N_pop];
for (h in 1:N_pop){
empirical_p[h] =  inv_logit(alpha[h]) - inv_logit(alpha[h] + b_prime[h]);
}
}
"
library(rstan)
m_empirical <- stan( model_code  = model_basic , data= d_list ,iter = 5000, cores = 4, seed=1, chains=4, control = list(adapt_delta=0.95, max_treedepth = 15))
m_transport <- stan( model_code  = model , data= d_list ,iter = 5000, cores = 4, seed=1, chains=4, control = list(adapt_delta=0.95, max_treedepth = 15))
s_basic <- extract.samples(m_empirical)
s <- extract.samples(m_transport)
library(scales)
#color stuff
require(RColorBrewer)#load package
col.pal <- brewer.pal(8, "Dark2") #create a pallette which you loop over for corresponding values
seqoverall <- seq
Society <- c("Berlin (GER)","La Plata (ARG)","Phoenix (USA)", "Pune (IND)", "Shuar (ECU)", "Wichí (ARG)")
par(mfrow= c(3,2),
oma=c(3,2,3,0),
mar=c(2,0,1,1))
for (i in 1:6) {
dens <- density(s_basic$empirical_p[,i])
x1 <- min(which(dens$x >= quantile(s_basic$empirical_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s_basic$empirical_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.7), border = NA))
abline(v = 0, lty = 2)
mtext(Society[i], side = 2, line = -3, cex = 0.7)
if (i ==1) legend("topright", c("Empirical estimates", "Transported estimates"), col = c(alpha("black",alpha = 0.7),alpha("black",alpha = 0.2)), cex = 0.7, lwd = 8, lty = 1, bty = "n")
par(new = TRUE)
dens <- density(s$transport_p[,i])
x1 <- min(which(dens$x >= quantile(s$transport_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s$transport_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.2), border = NA))
abline(v = 0, lty = 2)
}
mtext("Effect of norm prime on prosocial choices", side = 1,line = 1.5,outer = TRUE, cex = 0.8)
mtext("'Transport' of causal effect to the Wichí (ARG)", side = 3,line = 1.5,outer = TRUE, cex = 1)
graphics.off()
png("Transport2.png", res = 1200, height = 12, width = 16, units = "cm")
par(mfrow= c(3,2),
oma=c(3,2,3,0),
mar=c(2,0,1,1))
for (i in 1:6) {
dens <- density(s_basic$empirical_p[,i])
x1 <- min(which(dens$x >= quantile(s_basic$empirical_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s_basic$empirical_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.7), border = NA))
abline(v = 0, lty = 2)
mtext(Society[i], side = 2, line = -3, cex = 0.7)
if (i ==1) legend("topright", c("Empirical estimates", "Transported estimates"), col = c(alpha("black",alpha = 0.7),alpha("black",alpha = 0.2)), cex = 0.7, lwd = 8, lty = 1, bty = "n")
par(new = TRUE)
dens <- density(s$transport_p[,i])
x1 <- min(which(dens$x >= quantile(s$transport_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s$transport_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.2), border = NA))
abline(v = 0, lty = 2)
}
mtext("Effect of norm prime on prosocial choices", side = 1,line = 1.5,outer = TRUE, cex = 0.8)
mtext("'Transport' of causal effect to the Wichí (ARG)", side = 3,line = 1.5,outer = TRUE, cex = 1)
dev.off()
precis(m_transport)
precis(m_transport,3)
graphics.off()
png("Transport2.png", res = 1200, height = 12, width = 16, units = "cm")
par(mfrow= c(3,2),
oma=c(3,0,3,0),
mar=c(2,0,1,1))
for (i in 1:6) {
dens <- density(s_basic$empirical_p[,i])
x1 <- min(which(dens$x >= quantile(s_basic$empirical_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s_basic$empirical_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.7), border = NA))
abline(v = 0, lty = 2)
mtext(Society[i], side = 2, line = -3, cex = 0.7)
if (i ==1) legend("topright", c("Empirical estimates", "Transported estimates"), col = c(alpha("black",alpha = 0.7),alpha("black",alpha = 0.2)), cex = 0.7, lwd = 8, lty = 1, bty = "n")
par(new = TRUE)
dens <- density(s$transport_p[,i])
x1 <- min(which(dens$x >= quantile(s$transport_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s$transport_p[,i], 1)))
plot(dens, xlim = c(-0.3,0.9), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.2), border = NA))
abline(v = 0, lty = 2)
}
mtext("Effect of norm prime on prosocial choices", side = 1,line = 1.5,outer = TRUE, cex = 0.8)
mtext("'Transport' of causal effect to the Wichí (ARG)", side = 3,line = 1.5,outer = TRUE, cex = 1)
dev.off()
graphics.off()
png("Transport2.png", res = 1200, height = 12, width = 16, units = "cm")
par(mfrow= c(3,2),
oma=c(3,0,3,0),
mar=c(2,0,1,1))
for (i in 1:6) {
dens <- density(s_basic$empirical_p[,i])
x1 <- min(which(dens$x >= quantile(s_basic$empirical_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s_basic$empirical_p[,i], 1)))
plot(dens, xlim = c(-1,1), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.7), border = NA))
abline(v = 0, lty = 2)
mtext(Society[i], side = 2, line = -3, cex = 0.7)
if (i ==1) legend("topright", c("Empirical estimates", "Transported estimates"), col = c(alpha("black",alpha = 0.7),alpha("black",alpha = 0.2)), cex = 0.7, lwd = 8, lty = 1, bty = "n")
par(new = TRUE)
dens <- density(s$transport_p[,i])
x1 <- min(which(dens$x >= quantile(s$transport_p[,i], 0)))
x2 <- max(which(dens$x <  quantile(s$transport_p[,i], 1)))
plot(dens, xlim = c(-1,1), ylim = c(0,max(dens$y)), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[i],alpha = 0.2), border = NA))
abline(v = 0, lty = 2)
}
mtext("Effect of norm prime on prosocial choices", side = 1,line = 1.5,outer = TRUE, cex = 0.8)
mtext("'Transport' of causal effect to the Wichí (ARG)", side = 3,line = 1.5,outer = TRUE, cex = 1)
dev.off()
plot(precis(m_transport,3))
