#
# dens <- density(m12samp$psi)
# x1 <- min(which(dens$x >= quantile(m12samp$psi, 0)))
# x2 <- max(which(dens$x <  quantile(m12samp$psi, 1)))
# plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
# with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.3), border = NA))
mtext("Probability of choosing prosocial option", side = 1,line = 3,at=-0.1, outer = F, cex = 1)
legend("topleft", title = "Population", c("I","I (adjusted)", "II"), col = c(alpha(col.pal[4],alpha = 0.9),alpha(col.pal[4],alpha = 0.3),alpha(col.pal[5],alpha = 0.9)), lwd = 6, bty="n")
dev.off()
graphics.off()
png("Demostand2704.png", res = 600, height = 20, width = 16, units = "cm")
par(mfrow = c(3,2),
mar = c(3,1,3,2),
oma = c(1,4,0,0.1))
labels1 <- matrix("", length(Age_range), 2)
labels1[seq(5,75,10),1] <- seq(5,75,10)
labels2 <- matrix("", length(Age_range), 2)
par(mar=pyramid.plot(D[1,1, ]*100,D[1,2, ]*100,top.labels=c("", "Population I",""),ppmar=c(2,1,3,1), xlim = c(5,5),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
labels <- matrix("", length(Age_range), 2)
legend("topright", c("Male", "Female"), col = c("indianred", "darkgreen"),cex = 1, lty = 1,lwd = 5, bty = "n" )
mtext("Population", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(D[2,1, ]*100,D[2,2, ]*100,top.labels=c("", "Population II",""),ppmar=c(2,1,3,1), xlim = c(3,3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen", space = 0,gap = 0))
mtext("Share of population per age class and gender [%]", side = 1,line = 4,at = -5.5, outer = F, cex = 1)
par(mar=pyramid.plot(a1[1,],a1[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Sample", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(a2[1,],a2[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Number of individuals per age class and gender", side = 1,line = 4,at = -18, outer = F, cex = 1)
dens <- density(m11samp$phi)
x1 <- min(which(dens$x >= quantile(m11samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.9), border = NA))
abline(v = phi[1], lty = 2, lwd = 2)
par(new=TRUE)
dens <- density(m11samp$psi)
x1 <- min(which(dens$x >= quantile(m11samp$psi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$psi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.3), border = NA))
mtext("Density", side = 2,line = 3, outer = F, cex = 1)
dens <- density(m12samp$phi)
x1 <- min(which(dens$x >= quantile(m12samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m12samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.9), border = NA))
abline(v = phi[2], lty = 2, lwd = 2)
# par(new=TRUE)
#
# dens <- density(m12samp$psi)
# x1 <- min(which(dens$x >= quantile(m12samp$psi, 0)))
# x2 <- max(which(dens$x <  quantile(m12samp$psi, 1)))
# plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
# with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.3), border = NA))
mtext("Probability of choosing prosocial option", side = 1,line = 3,at=-0.1, outer = F, cex = 1)
legend("topleft", title = "Population", c("I","I (adjusted)", "II"), col = c(alpha(col.pal[4],alpha = 0.9),alpha(col.pal[4],alpha = 0.3),alpha(col.pal[5],alpha = 0.9)), lwd = 6, bty="n")
dev.off()
graphics.off()
png("Demostand2704.png", res = 600, height = 20, width = 16, units = "cm")
par(mfrow = c(3,2),
mar = c(3,1,3,2),
oma = c(1,4,0,0.1))
labels1 <- matrix("", length(Age_range), 2)
labels1[seq(5,75,10),1] <- seq(5,75,10)
labels2 <- matrix("", length(Age_range), 2)
par(mar=pyramid.plot(D[1,1, ]*100,D[1,2, ]*100,top.labels=c("", "Population I",""),ppmar=c(2,1,3,1), xlim = c(5,5),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
labels <- matrix("", length(Age_range), 2)
legend("topright", c("Male", "Female"), col = c("indianred", "darkgreen"),cex = 1, lty = 1,lwd = 5, bty = "n" )
mtext("Population", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(D[2,1, ]*100,D[2,2, ]*100,top.labels=c("", "Population II",""),ppmar=c(2,1,3,1), xlim = c(3,3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen", space = 0,gap = 0))
mtext("Share of population per age class and gender [%]", side = 1,line = 4,at = -4, outer = F, cex = 1)
par(mar=pyramid.plot(a1[1,],a1[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Sample", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(a2[1,],a2[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Number of individuals per age class and gender", side = 1,line = 4,at = -18, outer = F, cex = 1)
dens <- density(m11samp$phi)
x1 <- min(which(dens$x >= quantile(m11samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.9), border = NA))
abline(v = phi[1], lty = 2, lwd = 2)
par(new=TRUE)
dens <- density(m11samp$psi)
x1 <- min(which(dens$x >= quantile(m11samp$psi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$psi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.3), border = NA))
mtext("Density", side = 2,line = 3, outer = F, cex = 1)
dens <- density(m12samp$phi)
x1 <- min(which(dens$x >= quantile(m12samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m12samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.9), border = NA))
abline(v = phi[2], lty = 2, lwd = 2)
# par(new=TRUE)
#
# dens <- density(m12samp$psi)
# x1 <- min(which(dens$x >= quantile(m12samp$psi, 0)))
# x2 <- max(which(dens$x <  quantile(m12samp$psi, 1)))
# plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
# with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.3), border = NA))
mtext("Probability of choosing prosocial option", side = 1,line = 3,at=-0.1, outer = F, cex = 1)
legend("topleft", title = "Population", c("I","I (adjusted)", "II"), col = c(alpha(col.pal[4],alpha = 0.9),alpha(col.pal[4],alpha = 0.3),alpha(col.pal[5],alpha = 0.9)), lwd = 6, bty="n")
dev.off()
dens <- density(m11samp$phi)
x1 <- min(which(dens$x >= quantile(m11samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.9), border = NA))
abline(v = phi[1], lty = 2, lwd = 2)
par(new=TRUE)
par(mfrow = c(3,2),
mar = c(3,1,3,2),
oma = c(1,4,0,0.1))
labels1 <- matrix("", length(Age_range), 2)
labels1[seq(5,75,10),1] <- seq(5,75,10)
labels2 <- matrix("", length(Age_range), 2)
par(mar=pyramid.plot(D[1,1, ]*100,D[1,2, ]*100,top.labels=c("", "Population I",""),ppmar=c(2,1,3,1), xlim = c(5,5),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
labels <- matrix("", length(Age_range), 2)
legend("topright", c("Male", "Female"), col = c("indianred", "darkgreen"),cex = 1, lty = 1,lwd = 5, bty = "n" )
mtext("Population", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(D[2,1, ]*100,D[2,2, ]*100,top.labels=c("", "Population II",""),ppmar=c(2,1,3,1), xlim = c(3,3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen", space = 0,gap = 0))
mtext("Share of population per age class and gender [%]", side = 1,line = 4,at = -4, outer = F, cex = 0.9)
par(mar=pyramid.plot(a1[1,],a1[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Sample", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(a2[1,],a2[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Number of individuals per age class and gender", side = 1,line = 4,at = -18, outer = F, cex = 0.9)
dens <- density(m11samp$phi)
x1 <- min(which(dens$x >= quantile(m11samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.9), border = NA))
abline(v = phi[1], lty = 2, lwd = 2)
par(new=TRUE)
dens <- density(m11samp$psi)
x1 <- min(which(dens$x >= quantile(m11samp$psi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$psi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.3), border = NA))
mtext("Density", side = 2,line = 3, outer = F, cex = 1)
dens <- density(m12samp$phi)
x1 <- min(which(dens$x >= quantile(m12samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m12samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.9), border = NA))
abline(v = phi[2], lty = 2, lwd = 2)
# par(new=TRUE)
#
# dens <- density(m12samp$psi)
# x1 <- min(which(dens$x >= quantile(m12samp$psi, 0)))
# x2 <- max(which(dens$x <  quantile(m12samp$psi, 1)))
# plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
# with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.3), border = NA))
mtext("Probability of choosing prosocial option", side = 1,line = 3,at=-0.1, outer = F, cex = 1)
legend("topleft", title = "Population", c("I","I (adjusted)", "II"), col = c(alpha(col.pal[4],alpha = 0.9),alpha(col.pal[4],alpha = 0.3),alpha(col.pal[5],alpha = 0.9)), lwd = 6, bty="n")
dens <- density(m12samp$phi)
x1 <- min(which(dens$x >= quantile(m12samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m12samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.9), border = NA))
abline(v = phi[2], lty = 2, lwd = 2)
graphics.off()
png("Demostand2704.png", res = 600, height = 20, width = 16, units = "cm")
par(mfrow = c(3,2),
mar = c(3,1,3,2),
oma = c(1,4,0,0.1))
labels1 <- matrix("", length(Age_range), 2)
labels1[seq(5,75,10),1] <- seq(5,75,10)
labels2 <- matrix("", length(Age_range), 2)
par(mar=pyramid.plot(D[1,1, ]*100,D[1,2, ]*100,top.labels=c("", "Population I",""),ppmar=c(2,1,3,1), xlim = c(5,5),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
labels <- matrix("", length(Age_range), 2)
legend("topright", c("Male", "Female"), col = c("indianred", "darkgreen"),cex = 1, lty = 1,lwd = 5, bty = "n" )
mtext("Population", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(D[2,1, ]*100,D[2,2, ]*100,top.labels=c("", "Population II",""),ppmar=c(2,1,3,1), xlim = c(3,3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen", space = 0,gap = 0))
mtext("Share of population per age class and gender [%]", side = 1,line = 4,at = -4, outer = F, cex = 0.9)
par(mar=pyramid.plot(a1[1,],a1[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Sample", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(a2[1,],a2[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Number of individuals per age class and gender", side = 1,line = 4,at = -18, outer = F, cex = 0.9)
dens <- density(m11samp$phi)
x1 <- min(which(dens$x >= quantile(m11samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.9), border = NA))
abline(v = phi[1], lty = 2, lwd = 2)
par(new=TRUE)
dens <- density(m11samp$psi)
x1 <- min(which(dens$x >= quantile(m11samp$psi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$psi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.3), border = NA))
mtext("Density", side = 2,line = 3, outer = F, cex = 1)
dens <- density(m12samp$phi)
x1 <- min(which(dens$x >= quantile(m12samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m12samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.9), border = NA))
abline(v = phi[2], lty = 2, lwd = 2)
# par(new=TRUE)
#
# dens <- density(m12samp$psi)
# x1 <- min(which(dens$x >= quantile(m12samp$psi, 0)))
# x2 <- max(which(dens$x <  quantile(m12samp$psi, 1)))
# plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
# with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.3), border = NA))
mtext("Probability of choosing prosocial option", side = 1,line = 3,at=-0.1, outer = F, cex = 1)
legend("topleft", title = "Population", c("I","I (adjusted)", "II"), col = c(alpha(col.pal[4],alpha = 0.9),alpha(col.pal[4],alpha = 0.3),alpha(col.pal[5],alpha = 0.9)), lwd = 6, bty="n")
dev.off()
library(scales)
#color stuff
require(RColorBrewer)#load package
col.pal <- brewer.pal(8, "Dark2") #create a pallette which you loop over for corresponding values
seqoverall <- seq
graphics.off()
png("Demostand2704.png", res = 600, height = 20, width = 16, units = "cm")
par(mfrow = c(3,2),
mar = c(3,1,3,2),
oma = c(1,4,0,0.1))
labels1 <- matrix("", length(Age_range), 2)
labels1[seq(5,75,10),1] <- seq(5,75,10)
labels2 <- matrix("", length(Age_range), 2)
par(mar=pyramid.plot(D[1,1, ]*100,D[1,2, ]*100,top.labels=c("", "Population I",""),ppmar=c(2,1,3,1), xlim = c(5,5),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
labels <- matrix("", length(Age_range), 2)
legend("topright", c("Male", "Female"), col = c("indianred", "darkgreen"),cex = 1, lty = 1,lwd = 5, bty = "n" )
mtext("Population", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(D[2,1, ]*100,D[2,2, ]*100,top.labels=c("", "Population II",""),ppmar=c(2,1,3,1), xlim = c(3,3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen", space = 0,gap = 0))
mtext("Share of population per age class and gender [%]", side = 1,line = 4,at = -4, outer = F, cex = 0.9)
par(mar=pyramid.plot(a1[1,],a1[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Sample", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(a2[1,],a2[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Number of individuals per age class and gender", side = 1,line = 4,at = -18, outer = F, cex = 0.9)
dens <- density(m11samp$phi)
x1 <- min(which(dens$x >= quantile(m11samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.9), border = NA))
abline(v = phi[1], lty = 2, lwd = 2)
par(new=TRUE)
dens <- density(m11samp$psi)
x1 <- min(which(dens$x >= quantile(m11samp$psi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$psi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.3), border = NA))
mtext("Density", side = 2,line = 3, outer = F, cex = 1)
dens <- density(m12samp$phi)
x1 <- min(which(dens$x >= quantile(m12samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m12samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.9), border = NA))
abline(v = phi[2], lty = 2, lwd = 2)
# par(new=TRUE)
#
# dens <- density(m12samp$psi)
# x1 <- min(which(dens$x >= quantile(m12samp$psi, 0)))
# x2 <- max(which(dens$x <  quantile(m12samp$psi, 1)))
# plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
# with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.3), border = NA))
mtext("Probability of choosing prosocial option", side = 1,line = 2.9,at=-0.1, outer = F, cex = 0.9)
legend("topleft", title = "Population", c("I","I (adjusted)", "II"), col = c(alpha(col.pal[4],alpha = 0.9),alpha(col.pal[4],alpha = 0.3),alpha(col.pal[5],alpha = 0.9)), lwd = 6, bty="n", cex = 1.1)
dev.off()
library(scales)
#color stuff
require(RColorBrewer)#load package
col.pal <- brewer.pal(8, "Dark2") #create a pallette which you loop over for corresponding values
seqoverall <- seq
graphics.off()
png("Demostand2704.png", res = 600, height = 20, width = 16, units = "cm")
par(mfrow = c(3,2),
mar = c(3,1,3,2),
oma = c(1,4,0,0.1))
labels1 <- matrix("", length(Age_range), 2)
labels1[seq(5,75,10),1] <- seq(5,75,10)
labels2 <- matrix("", length(Age_range), 2)
par(mar=pyramid.plot(D[1,1, ]*100,D[1,2, ]*100,top.labels=c("", "Population I",""),ppmar=c(2,1,3,1), xlim = c(5,5),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
labels <- matrix("", length(Age_range), 2)
legend("topright", c("Male", "Female"), col = c("indianred", "darkgreen"),cex = 1, lty = 1,lwd = 5, bty = "n" )
mtext("Population", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(D[2,1, ]*100,D[2,2, ]*100,top.labels=c("", "Population II",""),ppmar=c(2,1,3,1), xlim = c(3,3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen", space = 0,gap = 0))
mtext("Share of population per age class and gender [%]", side = 1,line = 4,at = -4, outer = F, cex = 0.9)
par(mar=pyramid.plot(a1[1,],a1[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Sample", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(a2[1,],a2[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Number of individuals per age class and gender", side = 1,line = 4,at = -18, outer = F, cex = 0.9)
dens <- density(m11samp$phi)
x1 <- min(which(dens$x >= quantile(m11samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.9), border = NA))
abline(v = phi[1], lty = 2, lwd = 2)
par(new=TRUE)
dens <- density(m11samp$psi)
x1 <- min(which(dens$x >= quantile(m11samp$psi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$psi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.3), border = NA))
mtext("Density", side = 2,line = 3, outer = F, cex = 1)
dens <- density(m12samp$phi)
x1 <- min(which(dens$x >= quantile(m12samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m12samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.9), border = NA))
abline(v = phi[2], lty = 2, lwd = 2)
# par(new=TRUE)
#
# dens <- density(m12samp$psi)
# x1 <- min(which(dens$x >= quantile(m12samp$psi, 0)))
# x2 <- max(which(dens$x <  quantile(m12samp$psi, 1)))
# plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
# with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.3), border = NA))
mtext("Probability of choosing prosocial option", side = 1,line = 2.9,at=-0.1, outer = F, cex = 0.9)
legend("topleft", title = "Population", c("I","I (adjusted for demography of Population II)", "II"), col = c(alpha(col.pal[4],alpha = 0.9),alpha(col.pal[4],alpha = 0.3),alpha(col.pal[5],alpha = 0.9)), lwd = 6, bty="n", cex = 1.1)
dev.off()
library(scales)
#color stuff
require(RColorBrewer)#load package
col.pal <- brewer.pal(8, "Dark2") #create a pallette which you loop over for corresponding values
seqoverall <- seq
graphics.off()
png("Demostand2704.png", res = 600, height = 20, width = 16, units = "cm")
par(mfrow = c(3,2),
mar = c(3,1,3,2),
oma = c(1,4,0,0.1))
labels1 <- matrix("", length(Age_range), 2)
labels1[seq(5,75,10),1] <- seq(5,75,10)
labels2 <- matrix("", length(Age_range), 2)
par(mar=pyramid.plot(D[1,1, ]*100,D[1,2, ]*100,top.labels=c("", "Population I",""),ppmar=c(2,1,3,1), xlim = c(5,5),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
labels <- matrix("", length(Age_range), 2)
legend("topright", c("Male", "Female"), col = c("indianred", "darkgreen"),cex = 1, lty = 1,lwd = 5, bty = "n" )
mtext("Population", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(D[2,1, ]*100,D[2,2, ]*100,top.labels=c("", "Population II",""),ppmar=c(2,1,3,1), xlim = c(3,3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen", space = 0,gap = 0))
mtext("Share of population per age class and gender [%]", side = 1,line = 4,at = -4, outer = F, cex = 0.9)
par(mar=pyramid.plot(a1[1,],a1[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Sample", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(a2[1,],a2[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Number of individuals per age class and gender", side = 1,line = 4,at = -18, outer = F, cex = 0.9)
dens <- density(m11samp$phi)
x1 <- min(which(dens$x >= quantile(m11samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.9), border = NA))
abline(v = phi[1], lty = 2, lwd = 2)
par(new=TRUE)
dens <- density(m11samp$psi)
x1 <- min(which(dens$x >= quantile(m11samp$psi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$psi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.3), border = NA))
mtext("Density", side = 2,line = 3, outer = F, cex = 1)
legend("topright", title = "Population", c("I","I (adjusted for demography of Population II)", "II"), col = c(alpha(col.pal[4],alpha = 0.9),alpha(col.pal[4],alpha = 0.3),alpha(col.pal[5],alpha = 0.9)), lwd = 6, bty="n", cex = 1.1)
dens <- density(m12samp$phi)
x1 <- min(which(dens$x >= quantile(m12samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m12samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.9), border = NA))
abline(v = phi[2], lty = 2, lwd = 2)
# par(new=TRUE)
#
# dens <- density(m12samp$psi)
# x1 <- min(which(dens$x >= quantile(m12samp$psi, 0)))
# x2 <- max(which(dens$x <  quantile(m12samp$psi, 1)))
# plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
# with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.3), border = NA))
mtext("Probability of choosing prosocial option", side = 1,line = 2.9,at=-0.1, outer = F, cex = 0.9)
dev.off()
par(mfrow = c(3,2),
mar = c(3,1,3,2),
oma = c(1,4,0,0.1))
labels1 <- matrix("", length(Age_range), 2)
labels1[seq(5,75,10),1] <- seq(5,75,10)
labels2 <- matrix("", length(Age_range), 2)
par(mar=pyramid.plot(D[1,1, ]*100,D[1,2, ]*100,top.labels=c("", "Population I",""),ppmar=c(2,1,3,1), xlim = c(5,5),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
labels <- matrix("", length(Age_range), 2)
legend("topright", c("Male", "Female"), col = c("indianred", "darkgreen"),cex = 1, lty = 1,lwd = 5, bty = "n" )
mtext("Population", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(D[2,1, ]*100,D[2,2, ]*100,top.labels=c("", "Population II",""),ppmar=c(2,1,3,1), xlim = c(3,3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen", space = 0,gap = 0))
mtext("Share of population per age class and gender [%]", side = 1,line = 4,at = -4, outer = F, cex = 0.9)
par(mar=pyramid.plot(a1[1,],a1[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Sample", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(a2[1,],a2[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Number of individuals per age class and gender", side = 1,line = 4,at = -18, outer = F, cex = 0.9)
dens <- density(m11samp$phi)
x1 <- min(which(dens$x >= quantile(m11samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.9), border = NA))
abline(v = phi[1], lty = 2, lwd = 2)
par(new=TRUE)
dens <- density(m11samp$psi)
x1 <- min(which(dens$x >= quantile(m11samp$psi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$psi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.3), border = NA))
mtext("Density", side = 2,line = 3, outer = F, cex = 1)
legend("topright", title = "Population", c("I","I (adjusted for demography of Population II)", "II"), col = c(alpha(col.pal[4],alpha = 0.9),alpha(col.pal[4],alpha = 0.3),alpha(col.pal[5],alpha = 0.9)), lwd = 6, bty="n", cex = 1.1)
graphics.off()
png("Demostand2704.png", res = 600, height = 20, width = 16, units = "cm")
par(mfrow = c(3,2),
mar = c(3,1,3,2),
oma = c(1,4,0,0.1))
labels1 <- matrix("", length(Age_range), 2)
labels1[seq(5,75,10),1] <- seq(5,75,10)
labels2 <- matrix("", length(Age_range), 2)
par(mar=pyramid.plot(D[1,1, ]*100,D[1,2, ]*100,top.labels=c("", "Population I",""),ppmar=c(2,1,3,1), xlim = c(5,5),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
labels <- matrix("", length(Age_range), 2)
legend("topright", c("Male", "Female"), col = c("indianred", "darkgreen"),cex = 1, lty = 1,lwd = 5, bty = "n" )
mtext("Population", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(D[2,1, ]*100,D[2,2, ]*100,top.labels=c("", "Population II",""),ppmar=c(2,1,3,1), xlim = c(3,3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen", space = 0,gap = 0))
mtext("Share of population per age class and gender [%]", side = 1,line = 4,at = -4, outer = F, cex = 0.9)
par(mar=pyramid.plot(a1[1,],a1[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Sample", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(a2[1,],a2[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Number of individuals per age class and gender", side = 1,line = 4,at = -18, outer = F, cex = 0.9)
dens <- density(m11samp$phi)
x1 <- min(which(dens$x >= quantile(m11samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.9), border = NA))
abline(v = phi[1], lty = 2, lwd = 2)
par(new=TRUE)
dens <- density(m11samp$psi)
x1 <- min(which(dens$x >= quantile(m11samp$psi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$psi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.3), border = NA))
mtext("Density", side = 2,line = 3, outer = F, cex = 1)
legend("topright", title = "Population", c("I","I (poststratified)", "II"), col = c(alpha(col.pal[4],alpha = 0.9),alpha(col.pal[4],alpha = 0.3),alpha(col.pal[5],alpha = 0.9)), lwd = 6, bty="n", cex = 1.1)
dens <- density(m12samp$phi)
x1 <- min(which(dens$x >= quantile(m12samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m12samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.9), border = NA))
abline(v = phi[2], lty = 2, lwd = 2)
# par(new=TRUE)
#
# dens <- density(m12samp$psi)
# x1 <- min(which(dens$x >= quantile(m12samp$psi, 0)))
# x2 <- max(which(dens$x <  quantile(m12samp$psi, 1)))
# plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
# with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.3), border = NA))
mtext("Probability of choosing prosocial option", side = 1,line = 2.9,at=-0.1, outer = F, cex = 0.9)
dev.off()
library(scales)
#color stuff
require(RColorBrewer)#load package
col.pal <- brewer.pal(8, "Dark2") #create a pallette which you loop over for corresponding values
seqoverall <- seq
graphics.off()
png("Demostand2704.png", res = 600, height = 20, width = 16, units = "cm")
par(mfrow = c(3,2),
mar = c(3,1,3,2),
oma = c(1,4,0,0.1))
labels1 <- matrix("", length(Age_range), 2)
labels1[seq(5,75,10),1] <- seq(5,75,10)
labels2 <- matrix("", length(Age_range), 2)
par(mar=pyramid.plot(D[1,1, ]*100,D[1,2, ]*100,top.labels=c("", "Population I",""),ppmar=c(2,1,3,1), xlim = c(5,5),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
labels <- matrix("", length(Age_range), 2)
legend("topright", c("Male", "Female"), col = c("indianred", "darkgreen"),cex = 1, lty = 1,lwd = 5, bty = "n" )
mtext("Population", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(D[2,1, ]*100,D[2,2, ]*100,top.labels=c("", "Population II",""),ppmar=c(2,1,3,1), xlim = c(3,3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen", space = 0,gap = 0))
mtext("Share of population per age class and gender [%]", side = 1,line = 4,at = -4, outer = F, cex = 0.9)
par(mar=pyramid.plot(a1[1,],a1[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels1, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Sample", side = 2, outer = F, line = 3.5, cex = 1.3)
mtext("Age class", side = 2, outer = F, line = 0.2, cex = 1)
par(mar=pyramid.plot(a2[1,],a2[2,],top.labels=c("", "",""),ppmar=c(2,1,3,1), xlim = c(max(c(a1,a2)+3),max(c(a1,a2))+3),labelcex=1.2, unit = "",show.values=F, labels = labels2, lxcol = "indianred", rxcol = "darkgreen",space = 0,gap = 0))
mtext("Number of individuals per age class and gender", side = 1,line = 4,at = -18, outer = F, cex = 0.9)
dens <- density(m11samp$phi)
x1 <- min(which(dens$x >= quantile(m11samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.9), border = NA))
abline(v = phi[1], lty = 2, lwd = 2)
par(new=TRUE)
dens <- density(m11samp$psi)
x1 <- min(which(dens$x >= quantile(m11samp$psi, 0)))
x2 <- max(which(dens$x <  quantile(m11samp$psi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[4],alpha = 0.3), border = NA))
mtext("Density", side = 2,line = 3, outer = F, cex = 1)
dens <- density(m12samp$phi)
x1 <- min(which(dens$x >= quantile(m12samp$phi, 0)))
x2 <- max(which(dens$x <  quantile(m12samp$phi, 1)))
plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n", yaxt = "n")
with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.9), border = NA))
abline(v = phi[2], lty = 2, lwd = 2)
# par(new=TRUE)
#
# dens <- density(m12samp$psi)
# x1 <- min(which(dens$x >= quantile(m12samp$psi, 0)))
# x2 <- max(which(dens$x <  quantile(m12samp$psi, 1)))
# plot(dens, xlim = c(0,1), ylim = c(0,30), type="n", ann = FALSE, bty = "n")
# with(dens, polygon(x=c(x[c(x1,x1:x2,x2)]), y= c(0, y[x1:x2], 0), col=alpha(col.pal[5],alpha = 0.3), border = NA))
mtext("Probability of choosing prosocial option", side = 1,line = 2.9,at=-0.1, outer = F, cex = 0.9)
legend("topleft", title = "Population", c("I","I (poststratified)", "II"), col = c(alpha(col.pal[4],alpha = 0.9),alpha(col.pal[4],alpha = 0.3),alpha(col.pal[5],alpha = 0.9)), lwd = 6, bty="n", cex = 1)
dev.off()
